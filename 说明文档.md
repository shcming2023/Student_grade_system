# 学生成绩管理系统 - 项目说明文档

## 一、项目规划

### 1.1 项目背景与目标
本项目旨在为「Way To Future」体系（橡心国际）开发一套基于Web的学生成绩管理系统。系统需支持学生信息管理、成绩录入、查询统计、成绩单生成等核心功能，并适配Mac mini M4内网部署环境。

### 1.2 核心功能模块
1.  **基础数据管理**：学生、班级、年级、科目、教师信息的增删改查。
2.  **考试管理**：
    *   考试场次管理（学年、学期、状态）。
    *   试卷模板管理（关联科目、年级、设定题目结构）。
    *   试卷管理（关联考试、模板、分配出卷/阅卷教师）。
3.  **成绩管理**：
    *   在线阅卷登分（支持按题录入）。
    *   批量成绩更新。
    *   成绩统计分析（总分、排名、得分率）。
4.  **报表与输出**：
    *   个人成绩单生成（PDF导出，包含雷达图分析）。
    *   班级/年级成绩统计报表。
5.  **高级功能**（规划中）：
    *   Excel数据批量导入/导出。
    *   LLM智能分析与建议生成。

### 1.3 技术架构
*   **前端**：React 19, Vite, TailwindCSS, Radix UI, TanStack Query.
*   **后端**：Node.js, Express, tRPC.
*   **数据库**：MySQL 8.0+, Drizzle ORM.
*   **部署**：Docker / PM2 (Mac mini M4, macOS).

---

## 二、实施方案

### 2.1 开发规范
*   **环境**：Mac系统，Trae编辑器。
*   **代码规范**：所有函数需添加功能描述、参数说明、返回值注释。
*   **流程**：遵循 MCP Sequential Thinking，严格执行 TodoList。

### 2.2 数据模型设计
核心实体包括：
*   `users` / `teachers`: 用户与权限管理。
*   `students`, `classes`, `grades`: 学生组织架构。
*   `subjects`: 学科定义。
*   `exam_sessions`: 考试批次（如"2025秋季期末"）。
*   `exam_templates`: 试卷结构定义（包含 `questions`）。
*   `exams`: 实际考试实例（关联 Session 和 Template）。
*   `scores`: 学生答题得分记录。
*   `report_cards`: 生成的成绩单记录。

### 2.3 接口设计
采用 **tRPC** 协议进行前后端类型安全通信，主要Router包括：
*   `auth`: 认证相关。
*   `students`: 学生管理。
*   `teachers`: 教师管理。
*   `exams`: 考试与试卷管理。
*   `scores`: 成绩录入与查询。

---

## 三、进度记录

### 3.1 已完成事项
*   **数据库设计**：完成所有核心表结构设计与迁移（Drizzle Schema）。
*   **后端基础**：搭建Express + tRPC服务器，实现JWT认证。
*   **前端框架**：完成Dashboard布局，集成UI组件库。
*   **基础管理功能**：
    *   [x] 学生、班级、科目、试卷模板的CRUD。
    *   [x] 教师管理（添加、列表、权限控制）。
*   **考试业务流程**：
    *   [x] 考试场次创建与管理。
    *   [x] 试卷创建与关联（支持从模板复制）。
    *   [x] 题目管理（支持按模块、知识点设定）。
*   **成绩系统**：
    *   [x] 成绩录入界面（表格化、实时计算，已优化iPad端体验）。
    *   [x] 成绩单PDF生成逻辑（集成 ReportLab 实现A4双面输出）。
*   **权限控制**：
    *   [x] Python简化版实现用户认证 (User Model, Login/Logout, @login_required)。
*   **部署准备**：
    *   [x] 完成Mac mini M4部署脚本 (`deploy.sh`, `start.sh`)。
    *   [x] 编写 `DEPLOYMENT.md`。

### 3.2 待办事项 (ToDo List)
#### 优先级：高
1.  **Excel导入功能**：
    *   [x] 实现Excel文件解析与数据映射（试卷导入）。
    *   [x] 实现Excel批量导入学生/成绩。
2.  *   **报表系统完善**：
    *   [x] 完善 Python 版各类统计报表（实现场次统计、分数段分布、题目正确率分析）。

#### 优先级：中
1.  **LLM集成**：
    *   [ ] 集成LLM API进行学生成绩智能分析。
    *   [ ] 自动生成学习建议。
2.  **前端细节**：
    *   [ ] 优化移动端适配。
    *   [ ] 添加更多数据可视化图表。

### 3.4 CVM 部署指南 (CodeBuddy 官方方案)
本方案延续 CodeBuddy 的部署方式，使用 `start_student_system.sh` 脚本在 8083 端口运行。

1.  **部署步骤**：
    *   确保代码已同步至 `/opt/Way To Future考试管理系统/Student_grade_system`。
    *   执行启动脚本：
        ```bash
        cd "/opt/Way To Future考试管理系统/Student_grade_system"
        chmod +x start_student_system.sh
        ./start_student_system.sh
        ```

2.  **管理说明**：
    *   脚本会自动处理依赖 (requirements.txt)。
    *   应用运行在 **8083** 端口 (http://101.35.149.123:8083)。
    *   日志文件：`student_system.log`。

### 3.5 最近更新
*   **2025-12-28**: 完成Excel导入功能（试卷、学生、成绩）及统计报表Excel导出功能。
*   **2025-12-27**: 初始化文档，整理现有项目状态。确认系统已完成基础CRUD及核心考试流程，正处于功能完善与部署验证阶段。
